name: red
on: push
jobs:   
   first-job:
      runs-on: ubuntu-latest
      steps:
         - name: step Hello
           run: echo "Hello"

         - name: step world
           run: |
             echo "world" 

         - name: print run id and data
           run: |
              ID=$(curl -L \
                -H "Accept: application/vnd.github+json" \
                -H "X-GitHub-Api-Version: 2022-11-28" \
                https://api.github.com/repos/${GITHUB_REPOSITORY}/actions/runs/${GITHUB_RUN_ID}/attempts/${GITHUB_RUN_ATTEMPT}/jobs | jq .jobs[].id)
              
              curl -L \
                -H "Accept: application/vnd.github+json" \
                -H "X-GitHub-Api-Version: 2022-11-28" \
                "https://api.github.com/repos/${GITHUB_REPOSITORY}/actions/jobs/${ID}" >> abc.json
              
              # table=""S
              # table+="| Step number | Step Name | Step Status |\n"
              # table+="| ---- ------ | ---- ---- | ---- ------ |\n"
              echo "## Steps" >> $GITHUB_STEP_SUMMARY
              echo "**URL" >> $GITHUB_STEP_SUMMARY
              # echo "| Step number | Step Name | Step Status |" >> $GITHUB_STEP_SUMMARY
              jq -c '.steps | map(.) | .[]' abc.json | while read siteJSON;
              do 
                name=$(echo $siteJSON | jq -r .name) 
                status=$(echo $siteJSON | jq -r .conclusion) 
                number=$(echo $siteJSON | jq -r .number)
                start_time=$(echo $siteJSON | jq -r .started_at)
                complete_at=$(echo $siteJSON | jq -r .completed_at)
                # echo "| Step number | Step Name | Step Status |" >> $GITHUB_STEP_SUMMARY
                # echo "| $number     | $name     | $status     |"
                table+="| $number | $name | $status |\n"  
              done  

              echo "$table" >> $GITHUB_STEP_SUMMARY